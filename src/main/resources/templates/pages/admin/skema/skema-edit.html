<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/app}">

<head th:replace="~{fragments/header :: header('Edit Skema')}"></head>

<body>
  <div layout:fragment="content">
    <div class="container-fluid">
      <div class="row">
        <div class="col-12">
          <div class="card card-warning card-tabs">
            <div class="card-header p-0 pt-1">
              <ul class="nav nav-tabs" id="skema-tab" role="tablist">
                <li class="nav-item"><a class="nav-link active" id="skema-sertifikasi-tab" data-toggle="pill"
                    href="#skema-sertifikasi" role="tab">1. Skema Sertifikasi</a></li>
                <li class="nav-item"><a class="nav-link" id="unit-skema-tab" data-toggle="pill" href="#unit-skema"
                    role="tab">2. Unit Skema</a></li>
                <li class="nav-item"><a class="nav-link" id="unit-elemen-tab" data-toggle="pill" href="#unit-elemen"
                    role="tab">3. Elemen</a></li>
                <li class="nav-item"><a class="nav-link" id="kuk-tab" data-toggle="pill" href="#kuk" role="tab">4.
                    Kriteria Unjuk Kerja</a></li>
                <li class="nav-item"><a class="nav-link" id="persyaratan-tab" data-toggle="pill" href="#tab-persyaratan"
                    role="tab">5. Persyaratan</a></li>
              </ul>
            </div>

            <div class="card-body">
              <form id="form-edit-skema" th:action="@{/admin/skema/update}" method="post" enctype="multipart/form-data"
                novalidate th:object="${skemaDto}">
                <input type="hidden" th:field="*{id}" />

                <div class="tab-content">

                  <div class="tab-pane fade show active" id="skema-sertifikasi">
                    <div class="row">
                      <div class="col-12 text-right"><button type="button" class="btn btn-warning next-tab"
                          data-target-tab="unit-skema-tab">Selanjutnya <i class="fas fa-arrow-right"></i></button></div>
                    </div>

                    <div class="row">
                      <div class="col-md-12">
                        <div class="form-group"><label>Nama Skema</label><input type="text" class="form-control"
                            th:field="*{namaSkema}" required /></div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-3">
                        <div class="form-group"><label>Kode Skema</label><input type="text" class="form-control"
                            th:field="*{kodeSkema}" required /></div>
                      </div>
                      <div class="col-md-3">
                        <div class="form-group"><label>Level</label><input type="number" class="form-control"
                            th:field="*{level}" required /></div>
                      </div>
                      <div class="col-md-3">
                        <div class="form-group"><label>No SKKNI</label><input type="text" class="form-control"
                            th:field="*{noSkkni}" required /></div>
                      </div>
                      <div class="col-md-3">
                        <div class="form-group"><label>Tahun SKKNI</label><input type="text" class="form-control"
                            th:field="*{tahunSkkni}" required /></div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-6">
                        <div class="form-group"><label>Jenis Skema</label>
                          <select class="form-control select2" th:field="*{jenisSkemaId}" style="width: 100%" required>
                            <option th:each="type : ${types}" th:value="${type.id}" th:text="${type.name}"></option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="form-group"><label>Mode Skema</label>
                          <select class="form-control select2" th:field="*{modeSkemaId}" style="width: 100%" required>
                            <option th:each="mode : ${modes}" th:value="${mode.id}" th:text="${mode.name}"></option>
                          </select>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-6">
                        <div class="form-group"><label>Tanggal Penetapan</label><input type="date" class="form-control"
                            name="tanggalPenetapan" th:field="*{tanggalPenetapan}" required /></div>
                      </div>
                      <div class="col-md-6">
                        <div class="form-group"><label>File Dokumen (PDF)</label>
                          <div class="input-group">
                            <div class="custom-file">
                              <input type="file" class="custom-file-input" id="fileSkema" name="fileSkema"
                                accept=".pdf" />
                              <label class="custom-file-label" for="fileSkema">Ganti file (Opsional)</label>
                            </div>
                          </div>
                          <div class="mb-2" th:if="${existingSchema.documentPath}">
                            <small class="text-success"><i class="fas fa-check"></i> File terupload: <span
                                th:text="${existingSchema.documentPath}"></span></small>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="tab-pane fade" id="unit-skema">
                    <div class="row mb-3">
                      <div class="col-6"><button type="button" class="btn btn-secondary prev-tab"
                          data-target-tab="skema-sertifikasi-tab">Sebelumnya</button></div>
                      <div class="col-6 text-right"><button type="button" class="btn btn-warning next-tab"
                          data-target-tab="unit-elemen-tab">Selanjutnya</button></div>
                    </div>

                    <div id="unit-skema-container">
                      <div class="unit-skema-row card card-body mb-3" th:each="unit, stat : *{units}">
                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group"><label>Kode Unit</label><input type="text"
                                class="form-control input-kode-unit" th:name="|units[${stat.index}].kodeUnit|"
                                th:value="${unit.kodeUnit}" required /></div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-group"><label>Judul Unit</label><input type="text"
                                class="form-control input-judul-unit" th:name="|units[${stat.index}].judulUnit|"
                                th:value="${unit.judulUnit}" required /></div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-12 text-right"><button type="button"
                              class="btn btn-outline-danger btn-sm remove-unit-button"><i
                                class="fas fa-trash"></i></button></div>
                        </div>
                      </div>

                      <div class="unit-skema-row card card-body mb-3" th:if="*{#lists.isEmpty(units)}">
                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group"><label>Kode Unit</label><input type="text"
                                class="form-control input-kode-unit" name="units[0].kodeUnit" required /></div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-group"><label>Judul Unit</label><input type="text"
                                class="form-control input-judul-unit" name="units[0].judulUnit" required /></div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-12 text-right"><button type="button"
                              class="btn btn-outline-danger btn-sm remove-unit-button"><i
                                class="fas fa-trash"></i></button></div>
                        </div>
                      </div>
                    </div>
                    <div class="text-center mt-2"><button type="button" id="add-unit-button"
                        class="btn btn-outline-success"><i class="fas fa-plus"></i> Tambah Unit</button></div>
                  </div>

                  <div class="tab-pane fade" id="unit-elemen">
                    <div class="row mb-3">
                      <div class="col-6"><button type="button" class="btn btn-secondary prev-tab"
                          data-target-tab="unit-skema-tab">Sebelumnya</button></div>
                      <div class="col-6 text-right"><button type="button" class="btn btn-warning next-tab"
                          data-target-tab="kuk-tab">Selanjutnya</button></div>
                    </div>
                    <div class="alert alert-info py-2 small"><i class="fas fa-info-circle"></i> Jika unit berubah,
                      silakan sesuaikan dropdown induk.</div>

                    <div id="unit-elemen-container">
                      <div class="unit-elemen-row card card-body mb-3" th:each="el, stat : *{elements}">
                        <div class="row">
                          <div class="col-md-5">
                            <div class="form-group"><label>Judul Unit</label>
                              <select th:name="|elements[${stat.index}].unitIndex|"
                                class="form-control select2 select-unit-ref" required style="width: 100%;">
                                <option th:value="${el.unitIndex}" selected>Loading...</option>
                              </select>
                            </div>
                          </div>
                          <div class="col-md-2">
                            <div class="form-group"><label>No</label><input type="number" class="form-control"
                                th:name="|elements[${stat.index}].noElemen|" th:value="${el.noElemen}" required /></div>
                          </div>
                          <div class="col-md-5">
                            <div class="form-group"><label>Elemen</label><input type="text"
                                class="form-control input-nama-elemen" th:name="|elements[${stat.index}].namaElemen|"
                                th:value="${el.namaElemen}" required /></div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-12 text-right"><button type="button"
                              class="btn btn-outline-danger btn-sm remove-elemen-button"><i
                                class="fas fa-trash"></i></button></div>
                        </div>
                      </div>
                    </div>
                    <div class="text-center mt-2"><button type="button" id="add-elemen-button"
                        class="btn btn-outline-success"><i class="fas fa-plus"></i> Tambah Elemen</button></div>
                  </div>

                  <div class="tab-pane fade" id="kuk">
                    <div class="row mb-3">
                      <div class="col-6"><button type="button" class="btn btn-secondary prev-tab"
                          data-target-tab="unit-elemen-tab">Sebelumnya</button></div>
                      <div class="col-6 text-right"><button type="button" class="btn btn-warning next-tab"
                          data-target-tab="persyaratan-tab">Selanjutnya</button></div>
                    </div>

                    <div id="kuk-container">
                      <div class="kuk-row card card-body mb-3" th:each="k, stat : *{kuks}">
                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group"><label>Elemen</label>
                              <select th:name="|kuks[${stat.index}].elementIndex|"
                                class="form-control select2 select-element-ref" required style="width: 100%">
                                <option th:value="${k.elementIndex}" selected>Loading...</option>
                              </select>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-group"><label>Nama KUK</label><input type="text"
                                class="form-control input-nama-kuk" th:name="|kuks[${stat.index}].namaKuk|"
                                th:value="${k.namaKuk}" required /></div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-12 text-right"><button type="button"
                              class="btn btn-outline-danger btn-sm remove-kuk-button"><i
                                class="fas fa-trash"></i></button></div>
                        </div>
                      </div>
                    </div>
                    <div class="text-center mt-2"><button type="button" id="add-kuk-button"
                        class="btn btn-outline-success"><i class="fas fa-plus"></i> Tambah KUK</button></div>
                  </div>

                  <div class="tab-pane fade" id="tab-persyaratan">
                    <div class="row mb-3">
                      <div class="col-12"><button type="button" class="btn btn-secondary prev-tab"
                          data-target-tab="kuk-tab">Sebelumnya</button></div>
                    </div>

<div class="card card-outline card-info">
                        <div class="card-header">
                          <h3 class="card-title">Format Teks Persyaratan</h3>

                          <div
                            id="custom-summernote-toolbar"
                            class="float-right"
                          >
                            <div class="btn-group">
                              <button
                                type="button"
                                class="btn btn-sm btn-default"
                                data-command="bold"
                                title="Bold"
                              >
                                <i class="fas fa-bold"></i>
                              </button>
                              <button
                                type="button"
                                class="btn btn-sm btn-default"
                                data-command="italic"
                                title="Italic"
                              >
                                <i class="fas fa-italic"></i>
                              </button>
                              <button
                                type="button"
                                class="btn btn-sm btn-default"
                                data-command="underline"
                                title="Underline"
                              >
                                <i class="fas fa-underline"></i>
                              </button>
                            </div>

                            <div class="btn-group ml-2">
                              <button
                                type="button"
                                class="btn btn-sm btn-default"
                                data-command="insertUnorderedList"
                                title="Bullet List"
                              >
                                <i class="fas fa-list-ul"></i>
                              </button>
                              <button
                                type="button"
                                class="btn btn-sm btn-default"
                                data-command="insertOrderedList"
                                title="Number List"
                              >
                                <i class="fas fa-list-ol"></i>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>

                    <div id="persyaratan-container">
                      <div class="persyaratan-row row align-items-center mb-3" th:each="req, stat : *{persyaratan}">
                        <div class="col-11"><textarea class="form-control summernote-persyaratan" name="persyaratan[]"
                            th:utext="${req}"></textarea></div>
                        <div class="col-1"><button type="button"
                            class="btn btn-outline-danger btn-sm remove-persyaratan-button"><i
                              class="fas fa-trash"></i></button></div>
                      </div>
                    </div>
                    <div class="mt-3"><button type="button" id="add-persyaratan-button"
                        class="btn btn-outline-success btn-block"><i class="fas fa-plus"></i> Tambah
                        Persyaratan</button></div>
                  </div>

                </div>
                <div class="card-footer mt-3 text-left">
                  <button type="submit" class="btn btn-warning">Simpan Perubahan</button>
                  <a th:href="@{/admin/skema}" class="btn btn-default">Batal</a>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>
