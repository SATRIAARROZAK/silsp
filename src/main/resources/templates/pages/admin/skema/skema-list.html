<!DOCTYPE html>
<html
  lang="en"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/app}"
>
  <head th:replace="~{fragments/header :: header('Data Skema')}"></head>

  <body>
    <div layout:fragment="page-title">
      <h1 class="m-0">Data Skema</h1>
    </div>
    <div layout:fragment="breadcrumb">
      <ol class="breadcrumb float-sm-right">
        <li class="breadcrumb-item"><a href="#">Home</a></li>
        <li class="breadcrumb-item active">Data Skema</li>
      </ol>
    </div>
    <div layout:fragment="content">
      <div class="card">
        <div class="card-header">
          <div
            class="d-flex flex-column-reverse flex-md-row justify-content-md-between align-items-md-center gap-2 mb-3"
          >
            <form
              th:action="@{/}"
              method=""
              class="d-flex"
              style="width: 100%; max-width: 450px"
            >
              <input
                type="text"
                name="keyword"
                class="form-control me-2"
                placeholder="Cari Skema"
                th:value="${keyword}"
                aria-label="Search"
              />
              <button type="submit" class="btn btn-outline-info">Cari</button>
              <a
                th:href="@{/}"
                class="btn btn-outline-danger ms-2"
                title="Reset Pencarian"
                >Reset</a
              >
            </form>

            <a
              th:href="@{/admin/skema/tambah-skema}"
              class="btn btn-outline-primary"
            >
              <i class="fas fa-plus me-1"></i>Tambah Data
            </a>
          </div>
        </div>
        <!-- /.card-header -->
        <div class="card-body responsive">
          <table class="table table-bordered table-hover table-responsive-md">
            <thead>
              <tr class="text-center">
                <th>No</th>
                <th>Nama Skema</th>
                <th>Jenis Skema</th>
                <th>Level</th>
                <th>File</th>
                <th>Skema Unit</th>
                <th>Aksi</th>
              </tr>
            </thead>
            <!-- <tbody id="skemaTableBody"> -->

            <tbody>
              <tr th:each="skema, iter : ${listSkema}">
                <td
                  class="text-center"
                  th:text="${(currentPage * 10) + iter.count}"
                >
                  1
                </td>

                <td>
                  <span class="font-weight-bold d-block" th:text="${skema.name}"
                    >Nama Skema</span
                  >
                  <small class="text-muted" th:text="${skema.code}"
                    >SKM-001</small
                  >
                </td>

                <td
                  class="text-center"
                  th:text="${skema.schemaType?.name ?: '-'}"
                >
                  Jenis
                </td>

                <td class="text-center" th:text="${skema.level}">4</td>

                <td class="text-center">
                  <a
                    th:if="${skema.documentPath}"
                    th:href="@{'/uploads/skema/' + ${skema.documentPath}}"
                    class="btn btn-xs btn-outline-secondary"
                    target="_blank"
                    title="Download PDF"
                  >
                    <i class="fas fa-file-pdf fa-lg"></i>
                  </a>
                  <span th:unless="${skema.documentPath}">-</span>
                </td>

                <td class="text-center">
                  <button
                    class="btn btn-primary btn-sm btn-expand"
                    type="button"
                    data-toggle="collapse"
                    th:data-target="'#collapseUnit-' + ${skema.id}"
                    aria-expanded="false"
                  >
                    <i class="fas fa-folder-plus"></i>
                  </button>
                </td>

                <td class="text-center">
                  <div class="btn-group">
                    <a
                      th:href="@{'/admin/skema/view/' + ${skema.id}}"
                      class="btn btn-default btn-sm"
                      title="Lihat"
                      ><i class="fas fa-eye text-primary"></i
                    ></a>
                    <a
                      th:href="@{'/admin/skema/edit/' + ${skema.id}}"
                      class="btn btn-default btn-sm"
                      title="Edit"
                      ><i class="fas fa-pencil-alt text-warning"></i
                    ></a>
                    <a
                      th:href="@{'/admin/skema/delete/' + ${skema.id}}"
                      class="btn btn-default btn-sm delete-button"
                      title="Hapus"
                      ><i class="fas fa-trash text-danger"></i
                    ></a>
                  </div>
                </td>
              </tr>
              <tr class="collapse p-0" th:id="'collapseUnit-' + ${skema.id}">
                <td colspan="8" class="bg-light p-3">
                  <div class="card shadow-none border mb-0">
                    <div class="card-header">
                      <h6 class="card-title text-primary font-weight-bold">
                        <i class="fas fa-list-ul mr-2"></i> Daftar Unit
                        Kompetensi
                      </h6>
                    </div>
                    <div class="card-body p-0 table-responsive">
                      <table class="table table-sm table-valign-middle mb-0">
                        <thead class="thead-light">
                          <tr>
                            <th style="width: 10px">#</th>
                            <th style="width: 200px">Kode Unit</th>
                            <th>Judul Unit</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr th:each="unit, uIter : ${skema.units}">
                            <td th:text="${uIter.count}">1</td>
                            <td>
                              <code class="text-primary" th:text="${unit.code}"
                                >CODE</code
                              >
                            </td>
                            <td th:text="${unit.title}">Judul Unit</td>
                          </tr>
                          <tr th:if="${#lists.isEmpty(skema.units)}">
                            <td
                              colspan="3"
                              class="text-center text-muted font-italic py-2"
                            >
                              Belum ada unit kompetensi.
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="card-footer clearfix bg-white">
          <div class="row">
            <div class="col-sm-12 col-md-5">
              <div class="dataTables_info" role="status" aria-live="polite">
                Menampilkan <b th:text="${(currentPage * 10) + 1}">1</b> sampai
                <b th:text="${(currentPage * 10) + listSkema.size()}">10</b>
                dari <b th:text="${totalItems}">50</b> data
              </div>
            </div>
            <div class="col-sm-12 col-md-7">
              <ul
                class="pagination pagination-sm m-0 float-right"
                th:if="${totalPages > 0}"
              >
                <li
                  class="page-item"
                  th:classappend="${currentPage == 0} ? 'disabled'"
                >
                  <a
                    class="page-link"
                    th:href="@{/admin/skema(page=${currentPage - 1}, keyword=${keyword})}"
                    >&laquo;</a
                  >
                </li>

                <li
                  class="page-item"
                  th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
                  th:if="${i >= currentPage - 2 && i <= currentPage + 2}"
                  th:classappend="${i == currentPage} ? 'active'"
                >
                  <a
                    class="page-link"
                    th:href="@{/admin/skema(page=${i}, keyword=${keyword})}"
                    th:text="${i + 1}"
                    >1</a
                  >
                </li>

                <li
                  class="page-item"
                  th:classappend="${currentPage == totalPages - 1} ? 'disabled'"
                >
                  <a
                    class="page-link"
                    th:href="@{/admin/skema(page=${currentPage + 1}, keyword=${keyword})}"
                    >&raquo;</a
                  >
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
